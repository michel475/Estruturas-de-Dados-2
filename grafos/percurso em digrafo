#include <stdio.h>
#include <stdlib.h>

struct grafo{
	int **arestas;
	int *grau;
	int V;
};

typedef struct grafo *Grafo;

Grafo fogra(int v)
{
	Grafo g = (Grafo)malloc(sizeof(struct grafo));
	if(g != NULL)
	{
		g->arestas = (int**)malloc(v * sizeof(int*));
		g->grau = (int*)calloc(v, sizeof(int));
		g->V = v;
		int i;
		for(i=0; i<v; i++)
		{
			g->arestas[i] = (int*)malloc(v * sizeof(int));
			g->grau[i] = 0;
		}
	}
	
	return g;
}

int ise(Grafo g, int orig, int dest, int direcionado)
{
	if(g == NULL)
		return 0;
	if(orig < 0 || orig >= g->V || dest < 0 || dest >= g->V)
		return 0;
	int i=0;
	while(i<g->grau[orig] && g->arestas[orig][i] != dest)
		i++;
	if(g->arestas[orig][i] == dest)
		return 0; // ja existe aresta
	g->arestas[orig][g->grau[orig]] = dest;
	g->grau[orig]+=1;
	if(direcionado == 0)
	{
		g->arestas[dest][g->grau[dest]] = orig;
		g->grau[dest]+=1;
	}
	return 1;
}

int rev(Grafo g, int orig, int dest, int direcionado)
{
	if(g == NULL)
		return 0;
	if(orig < 0 || orig >= g->V || dest < 0 || dest >= g->V)
		return 0;
	int i=0;
	while(i<g->grau[orig] && g->arestas[orig][i] != dest)
		i++;
	if(i == g->grau[orig])
		return 0; //nao encontrou a aresta;
	g->grau[orig]-=1;
	g->arestas[orig][i] = g->arestas[orig][g->grau[orig]];
	if(direcionado == 0)
		rev(g, dest, orig, 1);
	return 1;
}

int ver(Grafo g, int orig, int dest)
{
	if(g == NULL)
		return 0;
	if(orig < 0 || orig >= g->V || dest < 0 || dest >= g->V)
		return 0;
	int i=0;
	while(i<g->grau[orig] && g->arestas[orig][i] != dest)
		i++;
	if(i == g->grau[orig])
		return 0; //nao encontrou a aresta;
	else{
		if(g->arestas[orig][i] == dest)
			return 1;
	}
}

int dfs_grafo(Grafo g, int orig, int dest)
{
	if(g == NULL)
		return 0;
	if(orig < 0 || orig >= g->V || dest < 0 || dest >= g->V)
		return 0;
	if(orig == dest)
		return 1;
	int pilha[g->V], topo=0, visitados[g->V], i;
	for(i=0; i<g->V; i++)
		visitados[i] = 0;
	pilha[0] = orig;
	topo+=1;
	while(topo > 0)
	{
		int visitado = pilha[--topo];
		for(i=0; i<g->grau[visitado]; i++)
		{
			if(g->arestas[visitado][i] == dest)
				return 1;
			else{
				if(visitados[g->arestas[visitado][i]] == 0)
				{
					visitados[g->arestas[visitado][i]] = g->arestas[visitado][i];
					pilha[topo] = g->arestas[visitado][i];
					topo+=1;
				}
			}
		}
	}
	return 0;
}

int main()
{
	Grafo g = fogra(6);
	ise(g, 0, 3, 0);
	ise(g, 3, 5, 1);
	ise(g, 5, 4, 0);
	printf(ver(g, 0, 3) ? "sim\n" : "nao\n");
	printf(ver(g, 3, 0) ? "sim\n" : "nao\n");
	printf(dfs_grafo(g, 5, 0) ? "yess\n" : "noo\n");
}
